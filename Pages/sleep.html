<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>وذكر | أذكار النوم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ثيم النوم الافتراضي: أرجواني عميق فخم */
            --bg: #0f0a1e;
            --nav-bg: rgba(15, 10, 30, 0.9);
            --card-bg: #1a142e;
            --text-main: #e2e8f0;
            --primary: #a78bfa; /* لافندر ناعم */
            --accent: #f59e0b; /* ذهبي نجمي */
            --shadow: 0 10px 30px rgba(0,0,0,0.5);
            --btn-bg: #241d3b;
        }

        [data-theme="light"] {
            /* الثيم الفاتح الهادئ */
            --bg: #f5f3ff;
            --nav-bg: rgba(255, 255, 255, 0.9);
            --card-bg: #ffffff;
            --text-main: #2e1065;
            --primary: #7c3aed;
            --accent: #d97706;
            --btn-bg: #f3f0ff;
            --shadow: 0 10px 25px rgba(124, 58, 237, 0.1);
        }

        /* حماية ومنع التحديد */
        * { 
            -webkit-tap-highlight-color: transparent; 
            user-select: none; 
            box-sizing: border-box; 
            outline: none; 
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body { 
            margin: 0; font-family: 'Cairo', sans-serif; min-height: 100vh;
            background: var(--bg);
            background-image: url('https://www.transparenttextures.com/patterns/stardust.png');
            display: flex; flex-direction: column; align-items: center;
            padding: 90px 15px 30px; color: var(--text-main);
            overflow-x: hidden;
        }

        /* الناف بار الموحد */
        .navbar {
            position: fixed; top: 0; width: 100%; height: 75px;
            background: var(--nav-bg); backdrop-filter: blur(20px);
            display: flex; align-items: center; justify-content: space-between;
            padding: 0 5%; z-index: 1000; box-shadow: var(--shadow);
            border-bottom: 1px solid rgba(167, 139, 250, 0.2);
        }

        .nav-icon {
            width: 45px; height: 45px; background: var(--btn-bg);
            border-radius: 15px; display: grid; place-items: center;
            color: var(--primary); cursor: pointer; font-size: 1.1rem;
        }

        .nav-title { font-family: 'Amiri'; font-size: 26px; color: var(--primary); font-weight: 700; }

        .container { width: 100%; max-width: 500px; }

        /* تصميم الكارد الليلي */
        .zkr-card {
            background: var(--card-bg); border-radius: 30px; padding: 30px 25px;
            margin-bottom: 25px; position: relative; box-shadow: var(--shadow);
            border: 1px solid rgba(167, 139, 250, 0.1);
            animation: fadeIn 0.8s ease;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .actions { display: flex; gap: 15px; position: absolute; top: 20px; left: 25px; }
        .action-icon { color: #64748b; cursor: pointer; transition: 0.3s; }
        .action-icon:hover { color: var(--accent); }

        .zkr-text {
            font-family: 'Amiri', serif; font-size: 1.55rem; line-height: 2;
            text-align: center; color: var(--text-main); margin: 35px 0 20px;
        }

        .zkr-source {
            display: block; text-align: center; font-size: 0.85rem;
            color: var(--accent); font-weight: 700; margin-bottom: 25px; opacity: 0.9;
        }

        /* زر التسبيح (المسبحة الليلية) */
        .counter-btn {
            width: 100%; padding: 18px; background: var(--btn-bg);
            color: var(--text-main); border: 2px solid rgba(167, 139, 250, 0.1);
            border-radius: 25px; font-size: 1.15rem; font-weight: 800;
            cursor: pointer; display: flex; justify-content: center; 
            align-items: center; gap: 12px;
        }

        .counter-btn span {
            background: var(--primary); color: #fff;
            min-width: 42px; height: 42px; display: grid; place-items: center;
            border-radius: 14px; font-size: 1.2rem;
            box-shadow: 0 5px 15px rgba(167, 139, 250, 0.3);
        }

        /* أنيميشن الانتهاء (صح مطور) */
        .counter-btn.done {
            background: var(--accent) !important;
            color: #000 !important;
            border: none;
            animation: finishPulse 0.5s ease;
        }

        @keyframes finishPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .check-mark { display: none; font-size: 1.5rem; }
        .counter-btn.done .check-mark { display: inline-block; }
        .counter-btn.done span, .counter-btn.done .btn-label { display: none; }

        #toast {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            background: var(--primary); color: #fff; padding: 12px 35px;
            border-radius: 50px; font-size: 0.9rem; display: none; z-index: 2000;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .reset-page {
            margin: 30px; background: transparent; border: 2px solid var(--primary);
            color: var(--primary); padding: 14px 45px; border-radius: 50px;
            font-weight: 800; cursor: pointer;
        }
    </style>
</head>
<body oncontextmenu="return false;">

    <nav class="navbar">
        <div class="nav-icon" onclick="toggleTheme()" id="theme-toggle">
            <i class="fa-solid fa-moon"></i>
        </div>
        <div class="nav-title">أذكار النوم</div>
        <div class="nav-icon" onclick="history.back()">
            <i class="fa-solid fa-chevron-left"></i>
        </div>
    </nav>

    <div class="container" id="azkar-list">
        </div>

    <button class="reset-page" onclick="location.reload()">إعادة البداية</button>

    <div id="toast"></div>

    <script>
    const sleepAzkar = [
            { text: "يجمع كفيه ثم ينفث فيهما فيقرأ: {قُلْ هُوَ اللَّهُ أَحَدٌ}، {قُلْ أَعُوذُ بِرَبِّ الْفَلَقِ}، {قُلْ أَعُوذُ بِرَبِّ النَّاسِ} ثم يمسح بهما ما استطاع من جسده يبدأ برأسه ووجهه.", count: 3, source: "يفعل ذلك ثلاث مرات" },
            { text: "قراءة آية الكرسي: {اللَّهُ لَا إِلَهَ إِلَّا هُوَ الْحَيُّ الْقَيُّومُ لَا تَأْخُذُهُ سِنَةٌ وَلَا نَوْمٌ...}", count: 1, source: "من قرأها لن يزال عليه من الله حافظ" },
            { text: "{آمَنَ الرَّسُولُ بِمَا أُنزِلَ إِلَيْهِ مِن رَّبِّهِ وَالْمُؤْمِنُونَ...} (أواخر سورة البقرة)", count: 1, source: "من قرأهما في ليلة كفتاه" },
            { text: "بِاسْمِكَ رَبِّي وَضَعْتُ جَنْبِي، وَبِكَ أَرْفَعُهُ، فَإِنْ أَمْسَكْتَ نَفْسِي فَارْحَمْهَا، وَإِنْ أَرْسَلْتَهَا فَاحْفَظْهَا، بِمَا تَحْفَظُ بِهِ عِبَادَكَ الصَّالِحِينَ.", count: 1, source: "رواه البخاري ومسلم" },
            { text: "اللَّهُمَّ إِنَّكَ خَلَقْتَ نَفْسِي وَأَنْتَ تَوَفَّاهَا، لَكَ مَمَاتُهَا وَمَحْيَاهَا، إِنْ أَحْيَيْتَهَا فَاحْفَظْهَا، وَإِنْ أَمَتَّهَا فَاغْفِرْ لَهَا. اللَّهُمَّ إِنِّي أَسْأَلُكَ العَافِيَةَ.", count: 1, source: "رواه مسلم" },
            { text: "اللَّهُمَّ قِنِي عَذَابَكَ يَوْمَ تَبْعَثُ عِبَادَكَ.", count: 3, source: "كان النبي ﷺ يضع يده تحت خده ويقولها" },
            { text: "بِاسْمِكَ اللَّهُمَّ أَمُوتُ وَأَحْيَا.", count: 1, source: "رواه البخاري" },
            { text: "سُبْحَانَ اللَّهِ (33)، الحَمْدُ لِلَّهِ (33)، اللَّهُ أَكْبَرُ (34)", count: 1, source: "خير لكما من خادم" },
            { text: "الحمدُ لله الذي أطعمَنا وسقانا وكفانا وآوانا، فكم ممن لا كافيَ له ولا مؤويَ.", count: 1, source: "رواه مسلم" },
            { text: "اللَّهُمَّ عَالِمَ الغَيْبِ وَالشَّهَادَةِ فَاطِرَ السَّمَاوَاتِ وَالأَرْضِ، رَبَّ كُلِّ شَيْءٍ وَمَلِيكَهُ، أَشْهَدُ أَنْ لا إِلَهَ إِلا أَنْتَ، أَعُوذُ بِكَ مِنْ شَرِّ نَفْسِي وَمِنْ شَرِّ الشَّيْطَانِ وَشِرْكِهِ.", count: 1, source: "رواه أبو داود والترمذي" },
            { text: "اللَّهُمَّ أَسْلَمْتُ نَفْسِي إِلَيْكَ، وَفَوَّضْتُ أَمْرِي إِلَيْكَ، وَوَجَّهْتُ وَجْهِي إِلَيْكَ، وَأَلْجَأْتُ ظَهْرِي إِلَيْكَ، رَغْبَةً وَرَهْبَةً إِلَيْكَ، لا مَلْجَأَ وَلا مَنْجَا مِنْكَ إِلا إِلَيْكَ، آمَنْتُ بِكِتَابِكَ الَّذِي أَنْزَلْتَ، وَبِنَبِيِّكَ الَّذِي أَرْسَلْتَ.", count: 1, source: "من قالهن ومات من ليلته مات على الفطرة" },
            { text: "قراءة سورة الملك {تَبَارَكَ الَّذِي بِيَدِهِ الْمُلْكُ...}", count: 1, source: "سورة منجية من عذاب القبر" },
            { text: "قراءة سورة السجدة {الم * تَنزِيلُ الْكِتَابِ لا رَيْبَ فِيهِ مِن رَّبِّ الْعَالَمِينَ...}", count: 1, source: "كان النبي ﷺ لا ينام حتى يقرأها" },
            { text: "قراءة سورة الكافرون {قُلْ يَا أَيُّهَا الْكَافِرُونَ...}", count: 1, source: "براءة من الشرك" },
            { text: "اللَّهُمَّ رَبَّ السَّمَوَاتِ السَّبْعِ وَرَبَّ الْعَرْشِ الْعَظِيمِ، رَبَّنَا وَرَبَّ كُلِّ شَيْءٍ، فَالِقَ الْحَبِّ وَالنَّوَى، وَمُنْزِلَ التَّوْرَاةِ وَالإِنْجِيلِ وَالْفُرْقَانِ، أَعُوذُ بِكَ مِنْ شَرِّ كُلِّ شَيْءٍ أَنْتَ آخِذٌ بِنَاصِيَتِهِ.", count: 1, source: "رواه مسلم" },
            { text: "اللَّهُمَّ أَنْتَ الأَوَّلُ فَلَيْسَ قَبْلَكَ شَيْءٌ، وَأَنْتَ الآخِرُ فَلَيْسَ بَعْدَكَ شَيْءٌ، وَأَنْتَ الظَّاهِرُ فَلَيْسَ فَوْقَكَ شَيْءٌ، وَأَنْتَ الْبَاطِنُ فَلَيْسَ دُونَكَ شَيْءٌ، اقْضِ عَنَّا الدَّيْنَ وَأَغْنِنَا مِنَ الْفَقْرِ.", count: 1, source: "دعاء الكفاية وقضاء الدين" },
            { text: "استغفر الله الذي لا إله إلا هو الحي القيوم وأتوب إليه.", count: 3, source: "غفرت ذنوبه وإن كانت مثل زبد البحر" }
        ];

        const list = document.getElementById('azkar-list');

        function render() {
            list.innerHTML = '';
            sleepAzkar.forEach((zkr, index) => {
                list.innerHTML += `
                    <div class="zkr-card">
                        <div class="actions">
                            <i class="fa-solid fa-rotate-left action-icon" onclick="resetSingle(${index}, ${zkr.count})"></i>
                            <i class="fa-regular fa-copy action-icon" onclick="copyZkr(${index})"></i>
                        </div>
                        <p class="zkr-text" id="text-${index}">${zkr.text}</p>
                        <span class="zkr-source">${zkr.source}</span>
                        <button class="counter-btn" id="btn-${index}" onclick="countDown(this)">
                            <span id="count-${index}">${zkr.count}</span>
                            <div class="btn-label">تكرار</div>
                            <i class="fa-solid fa-circle-check check-mark"></i>
                        </button>
                    </div>
                `;
            });
        }

        function countDown(btn) {
            let span = btn.querySelector('span');
            let count = parseInt(span.innerText);
            if (count > 1) {
                span.innerText = count - 1;
                if(navigator.vibrate) navigator.vibrate(35);
            } else {
                btn.classList.add('done');
                btn.innerHTML = 'تم بحمد الله <i class="fa-solid fa-circle-check check-mark" style="display:inline-block"></i>';
                btn.onclick = null;
                if(navigator.vibrate) navigator.vibrate([50, 40, 50]);
            }
        }

        function toggleTheme() {
            const body = document.body;
            const icon = document.querySelector('#theme-toggle i');
            if (body.getAttribute('data-theme') === 'light') {
                body.removeAttribute('data-theme');
                icon.className = 'fa-solid fa-moon';
            } else {
                body.setAttribute('data-theme', 'light');
                icon.className = 'fa-solid fa-sun';
            }
        }

        function resetSingle(index, original) {
            const btn = document.getElementById(`btn-${index}`);
            btn.classList.remove('done');
            btn.innerHTML = `<span id="count-${index}">${original}</span> <div class="btn-label">تكرار</div> <i class="fa-solid fa-circle-check check-mark"></i>`;
            btn.onclick = function() { countDown(this); };
            showToast("تمت إعادة العداد");
        }

        function copyZkr(index) {
            const txt = document.getElementById(`text-${index}`).innerText;
            navigator.clipboard.writeText(txt);
            showToast("نسخت الذكر بنجاح");
        }

        function showToast(m) {
            const t = document.getElementById('toast');
            t.innerText = m;
            t.style.display = 'block';
            setTimeout(()=> t.style.display='none', 2000);
        }

        // حماية ومنع النسخ
        document.addEventListener('copy', (e) => e.preventDefault());

        render();
    </script>
</body>
</html>
